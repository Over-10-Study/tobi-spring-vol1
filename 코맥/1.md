## 스프링이란 무엇인가?
스프링은 [자바 엔터프라이즈](https://ko.wikipedia.org/wiki/%EC%9E%90%EB%B0%94_%ED%94%8C%EB%9E%AB%ED%8F%BC,_%EC%97%94%ED%84%B0%ED%94%84%EB%9D%BC%EC%9D%B4%EC%A6%88_%EC%97%90%EB%94%94%EC%85%98) 애플리케이션 개발에 사용되는 **애플리케이션 프레임워크이다.** 애플리케이션 프레임워크는 애플리케이션 개발을 빠르고 효율적으로 할 수 있도록 애플리케이션의 바탕이되는 틀과 공통 프로그래밍 모델, 기술 API 등을 제공해준다.

### 애플리케이션의 기본 틀 - 스프링 컨테이너
- 스프링은 스프링 컨테이너 또는 애플리케이션 컨텍스트라고 불리는 스프링 런타임 엔진을 제공한다.
- 스프링 컨테이너는 설정정보를 참고하여 오브젝트를 생성하고 관리한다.
- 스프링 컨테이너는 보통 웹 모듈에서 동작하는 서비스나 스블릿으로 등록해서 사용한다.
- 스프링을 사용하려면 먼저 다음과 같은 두 가지가 필요하다.
  - 스프링 컨테이너를 다루는 방법
  - 스프링 컨테이너가 애플리케이션 오브젝트를 이용할 수 있도록 설정정보를 작성하는 법

### 공통 프로그래밍 모델 - IoC/DI, 서비스 추상화, AOP
보통 프로그래밍 모델이라고 하면 프레임워크가 애플리케이션 코드를 어떻게 작성돼야 하는지에 대한 기준이다. 스프링은 다음과 같은 세 가지 핵심 프로그래밍 모델을 지원한다.

- **IoC/DI**: 오브젝트의 생명주기와 의존관계에 대한 프로그래밍 모델
  - IoC/DI는 객체지향 설계 원칙과 디자인 패턴의 핵심이며, 이를 통해 유연하고 확장성이 뛰어난 코드를 보장한다.
  - 스프링이 제공하는 모든 기술과 API, 컨테이너가 IoC/DI 방식으로 작성되어 있다.
- **서비스 추상화**
  - 서비스 추상화를 통해 스프링을 사용하면 서버, 특정 기술에 종속되지 않고 이식성이 뛰어나며 유연한 애플리케이션을 만들 수 있다.
  - 구체적인 기술과 환경에 종속되지 않도록 유연한 추상 계층을 두는 방식이다.
- **AOP**: 애플리케이션 코드에 산재해서 나타나는 부가적인 기능을 독립적으로 모듈화하는 프로그래밍 모델
  - AOP를 통해 다양한 엔터프라이즈 서비스를 적용하고도 깔끔한 코드를 유지하도록 만들 수 있다.

### 기술 API
- 스프링은 엔터프라이즈 애플리케이션을 개발의 다양한 영역에 바로 활용할 수 있는 많는 기술 API를 제공한다.
- 기술 API은 모두 스프링의 프로그래밍 모델에 따라 작성되어 있으므로, 이를 가져다 쓰는 것만으로 스프링의 프로그래밍 모델을 코드에 적용할 수 있다.
- 스프링의 모든 기술은 자바 엔터프라이즈 플랫폼(JavaEE)에 기반을 둔다.

### 정리
스프링을 사용하면 클래스는 스프링 컨테이너 위에서 오브젝트로 만들어져 동작하게 만들고, 코드는 스프링의 프로그래밍 모델을 따라서 작성하고, 엔터프라이즈 기술을 사용할 때는 제공된 기술 API와 서비스를 활용할 수 있다.


# 1장 오브젝트와 의존관계
스프링은 자바를 기반으로 한 기술이므로, 자바에서 가장 중요하게 여기는 **객체지향 프로그래밍** 을 바탕으로 구현된 프레임워크이다. 그래서 스프링에서 가장 관심을 두는 대상은 **오브젝트** 이다. 오브젝트를 볼 때마다 다음과 같은 고민을 계속해서 해보자.
- 생성
- 다른 오브젝트와의 관계
- 소멸
- 설계
- 단위
- 어떤 과정을 통해 자신의 존재를 드러내고 등장해야 하는지
이에 대한 고민은 결국 오브젝트의 설계, 즉 **객체지향 설계** 로 이어진다.

## 초난감 DAO
사용자 정보를 JDBC API를 통해 DB에 저장하고 조회할 수 있는 간단한 DAO를 하나 만들어보자.

>> DAO(Data Access Object)
>> DAO는 DB를 사용해 데이터를 조회하거나 조작하는 기능을 전담하도록 만든 오브젝트를 말한다.

### User
사용자 정보를 저장할 때는 자바빈 규약을 따르는 오브젝트를 이용하면 편리하다. User클래스는 id, name, password 세 개의 프로퍼티를 가진다.

>> 자바빈(JavaBean)
>> 자바빈은 기존에는 다른 의미로 사용했지만, 현재는 다음 두 가지 관례를 따라 만들어진 오브젝트를
>> 말한다. 간단히 빈이라고도 부른다.
>> - 디폴트 생성자: 자바빈은 파라미터가 없는 디폴트 생성자를 갖고 있어야 한다. 툴이나 프레임워크에서
>> 리플렉션을 이용해 오브젝트를 생성하기 때문에 필요하다.
>> - 프로퍼티: 자바진이 노출하는 일므을 가진 속성을 프로퍼티라고 한다. 프로퍼티는 set으로 시작하는
>> 수정자 메소드(setter)와 get으로 시작하는 접근자 메소드(getter)를 이용해 수정 및 조회가 가능하다.

```java
public class User {
    private String id;
    private String name;
    private String password;

    public String getId() {
        return id;
    }

    public void setId(String id) {
        this.id = id;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public String getPassword() {
        return password;
    }

    public void setPassword(String password) {
        this.password = password;
    }
}
```

### UserDao
```UserDao```클래스는 사용자 정보를 DB에 넣고 관리할 수 있는 클래스이다. 일단 새로운 사용자를 생성하고(```add()```), 아이디(id)를 가지고 사용자 정보를 읽어오는(```get()```) 두 개의 메서드를 먼저 만들어보자.

JDBC를 이용하는 작업의 일반적인 순서는 다음과 같다.
- DB 연결을 위한 Connection을 가져온다.
- SQL을 담은 Statement(또는 PreparedStatement)를 만든다.
- 만들어진 Statement를 실행한다.
- 조회의 경우 SQL 쿼리의 실행 결과를 ResultSet으로 받아서 정보를 저장할 오브젝트(여기서는 User)에 옮겨준다.
- 작업 중에 생성된 Connection, Statement, ResultSet 같은 리소스는 작업을 마친 후 반드시 닫아준다.
- JDBC API가 만들어내는 예외를 잡아서 직접 처리하거나, 메소드에 ```throws```를 선언해서 예외가 발생하면 메소드 밖으로 던지게 한다.


### ```main()```을 이용한 DAO 테스트 코드
만들어진 코드의 기능을 검증하고자 할 때 사용할 수 있는 가장 간단한 방법은 **오브젝트 스스로 자신을 검증하도록** 만들어주는 것이다. 이를 가장 간단히 실행할 수 있는 것이 ```main()``` 스태틱 메서드이다.

이제 ```main()```를 만들고 그 안에서 ```UserDao```의 오브젝트를 생성하여 ```add()```와 ```get()``` 메소드를 실한 후 ```main()``` 메소드가 에러 없이 정상적으로 종료된다면 테스트가 완료되었다고 생각할 수 있다.

```java
```

위 코드 ```main()``` 메소드를 실행하면 정상적으로 종료된다. 하지만 이와 같이 ```UserDao```클래스를 개발한다면 **개발팀에서 바로 쫓겨난다.** 이를 객체지향 기술의 원리에 충실한 멋진 스프링 스타일의 코드로 개선해야 한다. 현재 ```UserDao``` 클래스는 기능적으로는 문제가 없다. 이를 테스트로도 확인했다. 하지만 객체지향의 관점에서는 매우 좋지 않은 코드다.

## DAO의 분리
### 관심사의 분리
**객체지햐의 세계에서는 모든 것이 변한다.** 여기서 변한다는 것은 오브젝트에 대한 설계와 이를 구현한 코드가 변한다는 뜻이다. 사용자의 비지니스 프로스세스와 그에 따른 요구사항은 끊임없이 변하고, 기술 역시 시간에 지남에 따라 바뀌고, 운영되는 환경도 변한다. 그러므로 개발자가 객체를 설계할 때 가장 고려해야할 점은 **미래의 변화를 어떻게 대비할 것인가** 이다.

그렇다면 변경이 일어날 때 필요한 작업을 최소화하고, 그 변경이 다른 곳에 문제를 일으키지 않게 하려면 **분리와 확장** 을 고려한 설계가 필요하다.

- 분리

개발을 하다보면 여러가지 변경 사항이 생길 수 있는데, 그 순간마다 비즈니스 로직이 담긴 코드의 구조를 모두 변경하거나 여러 클래스를 함께 수정해야한다면 매우 힘든 작업일 것이다.

변화가 한 번에 한 가지 관심에 집중돼서 일어난다면, 우리가 준비해야 할 일은 한 가지 관심이 한 군데에 집중되게 하는 것이다. 즉 **관심이 같은 것끼리는 모으고, 관심이 다른 것은 따로 떨어져 있게 하는 것이다.** 이를 프로그래밍 기초 개념 중 **관심사의 분리(Separation of Concerns)** 이다.

이를 객체지향에 적용해보면,
- 관심이 같은 것끼리는 하나의 객체 안으로 또는 친한 객체로 모이게 하고,
- 관심이 다른 것은 가능한 한 따로 떨어져서 서로 영향을 주지 않도록
분리해야한다.

### 커넥션 만들기의 추출
UserDao의 ```add()``` 메소드 하나에서만 다음과 같이 세 가지 관심사항이 존재한다.
- 첫째는 DB와 연결을 위한 커넥션을 어떻게 가져올까이다. 더 세분화하면
  - 어떤 DB를 쓰고,
  - 어떤 드라이버를 사용할 것이고,
  - 어떤 로그인 정보를 쓰는데,
  - 그 커넥션을 생성하는 방법은 어떤 것이다.
- 둘째는 사용자 등록을 위해 DB에 보낼 SQL 문장을 담을 Statement를 만들고 실행하는 것이다.
  - 파라미터로 넘어온 사용자 정보를 Statement에 바인딩시키고,
  - Statement에 담긴 SQL을 DB를 통해 실행시킨다.
- 셋째는 작업이 끝나면 사용한 리소스인 Statement와 Connection 오브젝트를 닫아줘서 공유 리소스를 시스템에 돌려준다.
